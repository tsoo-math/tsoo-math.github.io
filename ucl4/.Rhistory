z
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(1, metro(20))
z[,1]
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(1, metro(20))
z
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(2, metro(20))
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(2, metro(20))
z
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(4, metro(20))
z
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(4, metro(20))
z
x = z[1,]
y = z[2,]
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(4, metro(20))
z
x = z[1,]
y = z[2,]
x
y
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(2000, metro(200))
z
x = z[1,]
y = z[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
w <- table(x_c, y_c)
hist3D(w=w, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
z = replicate(2000, metro(200))
x = z[1,]
y = z[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
w <- table(x_c, y_c)
hist3D(w=w, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
w = replicate(2000, metro(200))
x = w[1,]
y = w[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
w = replicate(5000, metro(200))
x = w[1,]
y = w[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
w = replicate(2000, metro(500))
x = w[1,]
y = w[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
w = replicate(10000, metro(500))
x = rnorm(5000)
y = rnorm(5000)
library(plot3D)
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
h <- function(w){
x = w[1]
y = w[2]
z= exp(-x^2/2)*exp(-y^2/2)
z
}
Yq <- function(w){
x = w[1]
y = w[2]
yn =  runif(1,-0.3, 0.3) + y
xn = runif(1, -0.2, 0.2) +x
c(xn,yn)
}
a <- function(j,i){
m=min( c( h(j)/h(i), 1 ))
m
}
metro <- function(n){
x=0.5
y=0.5
for(k in 1:n){
i = c(x,y)
j = Yq(i)
p = a(j,i)
if (rbinom(1,1,p)==1) {
x = j[1]
y = j[2]
}
}
c(x,y)
}
w = replicate(5000, metro(500))
x = w[1,]
y = w[2,]
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
x = rnorm(5000)
y = rnorm(5000)
library(plot3D)
x_c <- cut(x, 20)
y_c <- cut(y, 20)
z <- table(x_c, y_c)
hist3D(z=z, border="black")
